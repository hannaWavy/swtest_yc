<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no">
    <title>sw test</title>
    <link rel="manifest" href="./manifest.json">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" sizes="72x72" href="./images/manifest/icon-72x72.png">
    <link rel="icon" sizes="96x96" href="./images/manifest/icon-96x96.png">
    <link rel="icon" sizes="128x128" href="./images/manifest/icon-128x128.png">
    <link rel="icon" sizes="144x144" href="./images/manifest/icon-144x144.png">
    <link rel="icon" sizes="152x152" href="./images/manifest/icon-152x152.png">
    <link rel="apple-touch-icon" href="./images/manifest/icon-52x52.png">
    <link rel="apple-touch-icon" sizes="72x72" href="./images/manifest/icon-72x72.png">
    <link rel="apple-touch-icon" sizes="120x120" href="./images/manifest/icon-120x120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="./images/manifest/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="167x167" href="./images/manifest/icon-167x167.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./images/manifest/icon-180x180.png">
    <style>
        .image-block {
            background-color: wheat;
            height: 200px;
            width: 200px;
            border: 2px solid green;
            margin: 20px;
        }
        form {
            padding: 20px 20px;
        }
    </style>
</head>
<body>
    <h1>this is the test page</h1>
    <button id="btnAdd" style="display: none">Add</button>
    <div id="messageBlock"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <form action="">
        <input type="text" placeholder="write something here" />
    </form>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
    <div class="image-block"></div>
</body>
<script>
    var deferredPrompt = false;
    var messageBlock = document.getElementById('messageBlock');
    var btnAdd = document.getElementById('btnAdd');


    if('serviceWorker' in navigator) {
        navigator.serviceWorker
            .register('./sw.js')
            // .then(function(registration) {});
            .then(function(registration) { console.log('ServiceWorker registration successful with scope: ', registration.scope); });
    }

    window.addEventListener('appinstalled', function() {
        messageBlock.textContent = "install_chrome_pwa";
    });

    window.addEventListener('beforeinstallprompt', function(e) {
        e.userChoice
            .then(function(choiceResult) {
                if (choiceResult.outcome === 'accepted') {
                    messageBlock.textContent = "add_chrome_banner";
                } else {
                    messageBlock.textContent = "close_chrome_banner";
                }
        });
    });

    // btnAdd.addEventListener('click', function(e) {
    //     if (deferredPrompt) {
    //         // hide our user interface that shows our A2HS button
    //         btnAdd.style.display = 'none';
    //         // Show the prompt
    //         deferredPrompt.prompt();
    //         // Wait for the user to respond to the prompt
    //         deferredPrompt.userChoice.then((choiceResult) => {
    //             if (choiceResult.outcome === 'accepted') {
    //                 messageBlock.textContent = "User accepted the A2HS prompt";
    //             } else {
    //                 messageBlock.textContent = "User dismissed the A2HS prompt";
    //             }
    //             deferredPrompt = null;
    //         });
    //     } else {
    //         messageBlock.textContent = "no event beforeinstallprompt";
    //     }
    // });

    //for ios
    // Detects if device is on iOS 
    // var isIos = function() {
    //     return /iphone|ipad|ipod/.test(window.navigator.userAgent.toLowerCase());
    // }
        
    // var isInStandaloneMode = function() { 
    //     return ('standalone' in window.navigator) && (window.navigator.standalone); 
    // };

    // // Checks if should display install popup notification:
    // if (isIos() && !isInStandaloneMode()) {
    //     console.log("show ios popup");
    // }
</script>
</html>